-- QueryRequest
-- TAM->TEE
json:  {"TYPE":1,"TOKEN":"1","REQUEST":[2]}
http_res:  {"recipients":[{"encrypted_key":"rdBnMwjMv2i_qzk45bMEiSOf7PCWdps8LuINJRop9PTP_ipu4269ZOoyo-7y2M6TnMIWWe3xwevrz3iUexzOgHBtFmfWtx0bK9qcSvb3x87cUzmSi1zUd1bjH8QdG8JpHcfaEtfxm5xQKweZD50owggErAKTu439dXRUq3gz5KI"}],"protected":"eyJlbmMiOiJBMTI4Q0JDLUhTMjU2IiwiYWxnIjoiUlNBLU9BRVAiLCJraWQiOiJXdXc2R3hfTGlBbF9iWkpUV2w3N1BuWENSZ0taWm9LTG1IMWRWbDBFbEZVIn0","iv":"bI8HjzfxvMRxBsaIVoDusg","ciphertext":"hrcJbSHv0MztWD3HpiSIQPABwLwVfU5v4CEousfBDlneQsS-dYA0cM515P9GRu95I5X-ocW6Ek2tdFJCv-h9rQEAxt1QpNgyc350Y3yThx2bv0Sc-lMGha_KiIhV5qVz-sbSzLVo7C5k4JF-kr6I9fZQE7iUHMoRhpbshfwpapvArNtIzp0ki-KhIEPb5nXK14Np36fxMnkY8YqlDy_iXfloXbBidybrFXU-uBEIEqezFL5Q-C4-ByIMyhdORaj6kBCRE6I2SdMoCGJmdgseY5TsYKTXfy8RKY13J33cZmKhFCyW96q9rOGa2r10cV9D4e_lrQ-ZdUhU9TjUdE_Gou5LQUF1QlH73mwLXcrntjkADQU-4onQXlRlOUVz5S1HE6BFYawBrOW5DNyvMWBHXG3OvzIZggVcf0889_M_Ebg3oKIED2N7ItlCUYx3xuG8cW9mF7rf_nFL-sp-0cutt9lHxrJ_-JcdOpvuxiGLNgpoRLg-LqFk7B1DU3h1JQti","tag":"C61yNfbQDHU-wbGLi7j7Yw"}

-- QueryResponse
-- TEE->TAM
json:  {"TYPE":2,"TOKEN":"1","TA_LIST":[{"Vendor_ID":"ietf-teep-wg","Class_ID":"3cfa03b5-d4b1-453a-9104-4e4bef53b37e","Device_ID":"teep-device"}]}
http_req:  {"recipients":[{"encrypted_key":"bMJGo-tgaqMboGx5aDLAljnZTkBIjjYay8QBEME3pRuM-ouE5rDZOkybsA1QotUs7_sjX3setNM0dhY3xYE0sQ5OPyx17TelpH4IHTlLAyJ0z5pT1aHNHp5xkGfYFUs6tlx06phOs6cha9OzE0jFkG4LmpfAatXVGBKLV9h8DHA"}],"protected":"eyJlbmMiOiJBMTI4Q0JDLUhTMjU2IiwiYWxnIjoiUlNBLU9BRVAiLCJraWQiOiJZWExZUE1QT1BhRUwyekRZS013bk1SNW5HZWpVQmZtVjF2ZGhONFZ0cmVrIn0","iv":"-dGnW_BeEYXKtQ7LnNIijQ","ciphertext":"8cU8b_oxM3TPmB7tjPPdOQc8EcEtLx97FgJOS5-OOQg9a4YeINgs8IlLXzL7_eNHLMqAjq2O4PXjgH3eSl-4NYkK5LgnOYxm3fuN-tO6Ba93Tq2WEd1cuwffEio1mcYTwOqDsjPlU6PWVeDCbm_mkigtYlrS9ECcvPzgoIMtHB3fToWAEWyDEcICO2RPHGUGD64wKOzNetImBJ2H8JFtQ_PUagWAJrWerkTXsraE0042M-a5CTaeP8JeYplkh72OOuD3NzbZ6EIqmvEDSTlHQNoWkB4lIMgO6TM11XWykQMYsrqSNXDPpfxx6GlhGyCk4_Wxz0WNpPJK-uHGZCiDwXB78IetCLjoewcfnZEK-Uir9qpLFQO0MxOy5f7pdIRzEzKcOSPo9ZDQcGmD6K6UiWPuu0FdwZjaaacFJ59yJeYeF9wuNT60PZUeSvpmSQZh3UYVFIF_7cOezSJjQT6IrFoEusA9c1U_yY7wwFRyiKr8reiGeVkvmdH48M143su4Bt1UcHRHAg-QZSXBZMUxhNNZeX5RIQxtdAErHqV7hxKedGAs1zKWQgYFHAyzDGzUwW6ZgBFYMg1y4fNJiPOQotpK76ixsy88A2SKbm8pHM9F2JdX4Litpl5BTBqqJ29rfOXRzruo6HfZDp_ZozMk5QlPyUXg-aHa-wBILDG5MVk","tag":"u_yTwLuSCNqk1V9dHoTjkg"}

-- TAM check whether tee has already installed 8d82573a-926d-4754-9353-32dc29997f74 or not
-- TrastedAppInstall
-- TAM->TEE
json:  {"TYPE":3,"TOKEN":"2","MANIFEST_LIST":[{"apply-image":[{"directive-set-ver":{"uri":"http://127.0.0.1/TAs/8d82573a-926d-4754-9353-32dc29997f74.ta"}}]}]}
http_res:  {"recipients":[{"encrypted_key":"Tx3tsWV3K4H1GOstssfOtoXR1LfYLLDAqwFUJ9Pq2lRIh5jOa5zHkk-qhB8sQ7VGTBhKH8GZVmKZRlJTpptoeZbkabWbXXDT0gitx-iwbD9MmtTnuHpceITvAWLQoI9vAT7Ec6cHNbTmbAM3ZIHEjINDG8ad0CUlS_cZEo_wl98"}],"protected":"eyJlbmMiOiJBMTI4Q0JDLUhTMjU2IiwiYWxnIjoiUlNBLU9BRVAiLCJraWQiOiJXdXc2R3hfTGlBbF9iWkpUV2w3N1BuWENSZ0taWm9LTG1IMWRWbDBFbEZVIn0","iv":"c6_K88VnAjwxgF24GYBwhA","ciphertext":"378B8GOKaV777EXyh7O2TW1XPk-D7tENJyEhXjnOGo-ARV3cHULVRw5-1_L1FM4Jjr9DKNsn7BbeswuWta8JstM8I5LH7EOmdxIt6vHVd_lcZasQWOYv5jhARTyEgsUbQYAdLDj5EEUUfEaLDCYulEpV_T2uhMPcjJhe3vMGQqN5_6tsr3b2OmmqhmKJpEWtsYRDAw65c6SZ8mmly_JMVtUla_ERePra8lchDDgiKKIAPB2lijOqMqOOaDIndx_336J1NOs7Dj8pqb6-imBMd0D4uc-rJ8o1mzBa6JQCsobr3Guq07jXuwxWJuifTvgFFebKVUso4_4vlb8rbHuchfTkXdUigSOiejyip8Ob8MYNV60DH3_vJgJTNdigdrLhVLRqy7XpCJ1qU6sbKD8Stg8kCUX0PVEngeLrpgVtI68iIl2irrq8LsPYQJ41dyknlysHwSj5r6MJUrjBP_dNXnx5GnPlQ7X8xYKyyywdYLEr4Sjuekb3TNYiI-TgDQEbeyre08evUPUY4iY9jPv3UlSosj8EJ9coJ4uXTWqtaHebPMHGK_VobB79obZjlI90i2ffSYPK_awJGZQKmUMaH2EmaaMrZinTKcMlT9YZtv5GsF4rlanSuFeooGLN9lLKIhK8sabNixif30azhyXEBeqVdDZYK4ELHdsLVn34P9FRls6g5n-ScXz5Vpvv3ujp","tag":"XM6y4qGzb_yyiT72hMGEog"}

-- retrieve TA image (TODO)
TEE->TAM request obtaining ta-image (http GET or otrp protocol)
TAM->TEE get TA image and verify with sp key

-- Success
-- TEE->TAM
json:  {"TYPE":5,"TOKEN":"2"}
http_req:  {"recipients":[{"encrypted_key":"QUwmeqtJUSpD4agxdedhO76gOun1uev9vZPQfCFUANlNjM0xaiyBzVmlhFCH_4ojtVf_B0dLoaXDA57a2vYau2lmeK2C3Q5RJBIxGkGkuCg6UL9gddPAahocNAQq0tPTrVv9YoBMokb9T5y1trl6M1lE7JI6bRxUyMGsRrkRC3s"}],"protected":"eyJlbmMiOiJBMTI4Q0JDLUhTMjU2IiwiYWxnIjoiUlNBLU9BRVAiLCJraWQiOiJZWExZUE1QT1BhRUwyekRZS013bk1SNW5HZWpVQmZtVjF2ZGhONFZ0cmVrIn0","iv":"BTnPkQ1kSw7RUnoNjvnNSg","ciphertext":"zVPxR8YEdTxKSl4zMnIpa_1MmnHBw03UIDnvtQ2bX3RyEc5UXMR6X73xUgHc3r5GcEFJjh07OrLK57aYMFGacsdIONapkyNQWwl1f25b_0SK0IbmVWwnPMz0bT09YX39krqgfRffC3leZw4tRbD3Z4BZwghvUp-K6x4HbaxQen4c0x8x_bQ_lfx4ENqy9Lf-b1zKEgpOlAqrL5BCbRyWvVdQ7usN22nnfeo9PEHMIxW-NfivSXTLRg6KfMNQ2K6bJTFzxJlQGQHOugmmg_OIa62RwBjqwNzFjCIp2m7n-hWgB6jnkjzaimm7dLjuxin3kdxBsNKqq3CB06MeS3Oo1CtvfHAXCRQnO2tZwKaiHizotP3-arxhu5lVyP8K0wDKQr2ys1IWmaF-zgp0mI77tuNKqBI5qDzzonbUlZaSUuUjaCOgPUU-Io6afGQdvKFtpA98nwg2XAbXPr1cEDGByI0Q9nWhdI3vjS-Cyv39sDE","tag":"FKIRk7lLYyexkeqgXugUuQ"}

finish
